[["the-bayesian-approach-in-practice-bayesian.html", "The Bayesian approach in practice {#Bayesian} 4.3 Example 5.2: Chronic obstructive pulmonary disease (COPD) in England 4.4 Example 5.3: Fitting a Poisson regression model in Nimble", " The Bayesian approach in practice {#Bayesian} 4.3 Example 5.2: Chronic obstructive pulmonary disease (COPD) in England We now look at example into the hospital admission rates for chronic obstructive pulmonary disease (COPD) in England between 2001–2010. In England, there are 324 local authority administrative areas each with an observed and expected number of cases. The expected numbers were calculated using indirect standardization by applying the age–sex specific rates for the whole of England to the age–sex population profile of each of the areas. 4.3.1 Reading in data and shapefiles To create SMR maps, we need to read in the relevant shapefiles. The files englandlocalauthority.shp and englandlocalauthority.dbf contain the location, shape, and attributes of English local authorities. The functions read.shp and read.dbf() will read these shapefiles into R # Reading in borders # copd_shp &lt;- read.shp(shp.name= &quot;englandlocalauthority.shp&quot;) # copd_dbf &lt;- read.dbf(dbf.name= &quot;englandlocalauthority.dbf&quot;) 4.4 Example 5.3: Fitting a Poisson regression model in Nimble The following code is used to fit the Poisson log-linear model seen in Chapter 2 Section … using Nimble First, define the model in Nimble. Example5_3Code &lt;- nimbleCode({ for (i in 1:N) { Y[i] ~ dpois(mu[i]) log(mu[i]) &lt;- log(E[i]) + beta0 + beta1 * X1[i] + betad * X2[i] } # Priors beta0 ~ dnorm (0 , sd = 100) beta1 ~ dnorm (0 , sd = 100) betad ~ dnorm (0 , sd = 100) # Functions of interest: base &lt;- exp(beta0) RR &lt;- exp(beta1) }) Read the data and define the constants, data and initials lists for the Nimble model. data &lt;- read.csv(&quot;data/DataExample53.csv&quot;, sep = &quot;,&quot;) ex.const &lt;- list( N = 393, E = data$exp_lungc65pls, X1 = as.vector(scale(data$k3)), X2 = as.vector(scale(data$k2)) ) ex.data &lt;- list(Y = data$lungc65pls) inits &lt;- function() list(beta0 = rnorm(1), beta1 = rnorm(1), betad = rnorm(1)) Define the parameters’ monitors and run the model. Check the WAIC. samples$WAIC ## nimbleList object of type waicList ## Field &quot;WAIC&quot;: ## [1] 3049.342 ## Field &quot;lppd&quot;: ## [1] -1514.46 ## Field &quot;pWAIC&quot;: ## [1] 10.2115 Show the trace plots and posterior summaries for each of the parameters. mvSamples &lt;- samples$samples #trace plots of beta1 plot(mvSamples[, c(&quot;beta1&quot;)]) #trace plots of base plot(mvSamples[, c(&quot;base&quot;)]) #trace plots of RR plot(mvSamples[, c(&quot;RR&quot;)]) #posterior summary of base summary(mvSamples[, c(&quot;base&quot;)]) ## ## Iterations = 1:2000 ## Thinning interval = 1 ## Number of chains = 2 ## Sample size per chain = 2000 ## ## 1. Empirical mean and standard deviation for each variable, ## plus standard error of the mean: ## ## Mean SD Naive SE Time-series SE ## 1.1284015 0.0125449 0.0001984 0.0001983 ## ## 2. Quantiles for each variable: ## ## 2.5% 25% 50% 75% 97.5% ## 1.104 1.120 1.128 1.137 1.153 #posterior summary of RR summary(mvSamples[, c(&quot;RR&quot;)]) ## ## Iterations = 1:2000 ## Thinning interval = 1 ## Number of chains = 2 ## Sample size per chain = 2000 ## ## 1. Empirical mean and standard deviation for each variable, ## plus standard error of the mean: ## ## Mean SD Naive SE Time-series SE ## 1.0144946 0.0177544 0.0002807 0.0004325 ## ## 2. Quantiles for each variable: ## ## 2.5% 25% 50% 75% 97.5% ## 0.9799 1.0022 1.0145 1.0262 1.0493 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
