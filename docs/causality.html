<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Causality-roadblocks on the way to it | Spatio-temporal methods in environmental epidemiology</title>
  <meta name="description" content="Chapter 13 Causality-roadblocks on the way to it | Spatio-temporal methods in environmental epidemiology" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Causality-roadblocks on the way to it | Spatio-temporal methods in environmental epidemiology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/img/cover.jpg" />
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Causality-roadblocks on the way to it | Spatio-temporal methods in environmental epidemiology" />
  
  
  <meta name="twitter:image" content="/img/cover.jpg" />

<meta name="author" content="Gavin Shaddick, James V. Zidek, and Alexandra M. Schmidt" />


<meta name="date" content="2023-02-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exposure.html"/>
<link rel="next" href="monitoring.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatio-temporal methods in environmental epidemiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="preface-2nd-edition.html"><a href="preface-2nd-edition.html"><i class="fa fa-check"></i>Preface (2nd edition)</a></li>
<li class="chapter" data-level="1" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>1</b> Why spatio-temporal epidemiology?</a></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Epidemiology-the basics</a></li>
<li class="chapter" data-level="3" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>3</b> Uncertainty and its reduction</a></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data: increasing information and reducing uncertainty</a></li>
<li class="chapter" data-level="5" data-path="embracing.html"><a href="embracing.html"><i class="fa fa-check"></i><b>5</b> Embracing uncertainty: the Bayesian approach</a></li>
<li class="chapter" data-level="6" data-path="tactics.html"><a href="tactics.html"><i class="fa fa-check"></i><b>6</b> Tactics-implementing uncertainty models</a>
<ul>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#example-6.2-chronic-obstructive-pulmonary-disease-copd-in-england"><i class="fa fa-check"></i>Example 6.2: Chronic obstructive pulmonary disease (COPD) in England</a>
<ul>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#modelling-the-raw-standardized-mortality-rates-smrs"><i class="fa fa-check"></i>Modelling the raw standardized mortality rates (SMRs)</a></li>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#modelling-a-poisson-gamma-with-an-mcmc-implemented-in-r"><i class="fa fa-check"></i>Modelling a Poisson-Gamma with an MCMC implemented in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#example-6.3-fitting-a-poisson-regression-model-in-nimble"><i class="fa fa-check"></i>Example 6.3: Fitting a Poisson regression model in <code>Nimble</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="strategies.html"><a href="strategies.html"><i class="fa fa-check"></i><b>7</b> Strategies-implementing uncertainty models</a></li>
<li class="chapter" data-level="8" data-path="trusted.html"><a href="trusted.html"><i class="fa fa-check"></i><b>8</b> But-can the data be trusted</a></li>
<li class="chapter" data-level="9" data-path="Disease.html"><a href="Disease.html"><i class="fa fa-check"></i><b>9</b> Disease-spatial patterns</a>
<ul>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.1-empirical-bayes-and-bayes-smoothing-of-copd-mortality-for-2010"><i class="fa fa-check"></i>Example 9.1: Empirical Bayes and Bayes smoothing of COPD mortality for 2010</a>
<ul>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#nimble"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.3-fitting-a-conditional-spatial-model-in-nimble-and-stan"><i class="fa fa-check"></i>Example 9.3: Fitting a conditional spatial model in <code>nimble</code> and <code>stan</code></a>
<ul>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#nimble-1"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#stan-1"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.4-fitting-a-conditional-spatial-model-using-carbayes"><i class="fa fa-check"></i>Example 9.4: Fitting a conditional spatial model using CARBayes</a></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.5-fitting-a-conditional-model-using-inla"><i class="fa fa-check"></i>Example 9.5: Fitting a conditional model using INLA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hazards.html"><a href="hazards.html"><i class="fa fa-check"></i><b>10</b> Environmental hazards-spatial models</a>
<ul>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.1"><i class="fa fa-check"></i>Example 10.1</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.2"><i class="fa fa-check"></i>Example 10.2</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.5"><i class="fa fa-check"></i>Example 10.5</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.6"><i class="fa fa-check"></i>Example 10.6</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.9"><i class="fa fa-check"></i>Example 10.9</a>
<ul>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#nimble-2"><i class="fa fa-check"></i>Nimble</a></li>
</ul></li>
<li class="chapter" data-level="10.1" data-path="hazards.html"><a href="hazards.html#example-10.13"><i class="fa fa-check"></i><b>10.1</b> Example 10.13</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Time.html"><a href="Time.html"><i class="fa fa-check"></i><b>11</b> Time-why it also matters</a>
<ul>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.1-ground-level-ozone-concentrations"><i class="fa fa-check"></i>Example 11.1 Ground level ozone concentrations</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.2-low-pass-filtering-of-carbon-monoxide-levels-using-the-moving-average"><i class="fa fa-check"></i>Example 11.2 Low-pass filtering of carbon monoxide levels using the moving average</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.13-forecasting-ozone-levels"><i class="fa fa-check"></i>Example 11.13 Forecasting ozone levels</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.14-forecasting-volcanic-ash"><i class="fa fa-check"></i>Example 11.14 Forecasting volcanic ash</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.16-implementation-of-a-dynamic-linear-model"><i class="fa fa-check"></i>Example 11.16 implementation of a dynamic linear model</a>
<ul>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#autoregressive-model-daily-data"><i class="fa fa-check"></i>Autoregressive model daily data</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#uk-ozone-data-rw"><i class="fa fa-check"></i>UK ozone data RW</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#uk-ozone-data-linear-growth"><i class="fa fa-check"></i>UK ozone data linear growth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="exposure.html"><a href="exposure.html"><i class="fa fa-check"></i><b>12</b> Exposure assessment-over space and time</a></li>
<li class="chapter" data-level="13" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>13</b> Causality-roadblocks on the way to it</a>
<ul>
<li class="chapter" data-level="13.1" data-path="causality.html"><a href="causality.html#solutions-to-selected-exercises"><i class="fa fa-check"></i><b>13.1</b> Solutions to Selected Exercises</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="causality.html"><a href="causality.html#question-13.16-load-the-italy-and-china-data-described-in-example-13.3-and-included-in-the-supplementary-bookdown-material-into-r."><i class="fa fa-check"></i><b>13.1.1</b> Question 13.16: Load the Italy and China data, described in Example 13.3, and included in the supplementary Bookdown material into R.</a></li>
<li class="chapter" data-level="13.1.2" data-path="causality.html"><a href="causality.html#question-13.17-using-the-italy-and-china-data-stratified-by-the-age-groups-70-and-geq-70-obtain-empirical-estimates-of-p_1-and-p_2-as-defined-in-an-sdis.-in-the-following-questions-assume-that-p_1-and-p_2-are-the-population-values."><i class="fa fa-check"></i><b>13.1.2</b> Question 13.17: Using the Italy and China data stratified by the age groups <span class="math inline">\(&lt;70\)</span> and <span class="math inline">\(\geq 70\)</span>, obtain empirical estimates of <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span>, as defined in an SDis. In the following questions, assume that <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span> are the population values.</a></li>
<li class="chapter" data-level="13.1.3" data-path="causality.html"><a href="causality.html#question-13.18-stratify-the-italy-and-china-data-by-the-age-groups-50-and-geq-50.-display-the-corresponding-contingency-tables."><i class="fa fa-check"></i><b>13.1.3</b> Question 13.18: Stratify the Italy and China data by the age groups <span class="math inline">\(&lt;50\)</span> and <span class="math inline">\(\geq 50\)</span>. Display the corresponding contingency tables.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="monitoring.html"><a href="monitoring.html"><i class="fa fa-check"></i><b>14</b> Better monitoring network design-getting better measurements</a></li>
<li class="chapter" data-level="15" data-path="frontiers.html"><a href="frontiers.html"><i class="fa fa-check"></i><b>15</b> Current frontiers</a></li>
<li class="chapter" data-level="" data-path="course.html"><a href="course.html"><i class="fa fa-check"></i>Course</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatio-temporal methods in environmental epidemiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causality" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Causality-roadblocks on the way to it<a href="causality.html#causality" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter contains a discussion of the differences between causality and association. It also covers specific issues that may be encountered in this area when investigating the effects of environmental hazards on health. From this chapter, the reader will have gained an understanding of the following topics:</p>
<ul>
<li>Issues with causality in observational studies.</li>
<li>The Bradford–Hill criteria which are a group of minimal conditions necessary to provide adequate evidence of a causal relationship.</li>
<li>Ecological bias which may occur when inferences about the nature of individuals are made using aggregated data.</li>
<li>The role of exposure variability in determining the extent of ecological bias.</li>
<li>Approaches to acknowledging ecological bias in ecological studies.</li>
<li>Concentration and exposure response functions.</li>
<li>Models for estimating personal exposures including micro-environments.</li>
</ul>
<div id="solutions-to-selected-exercises" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Solutions to Selected Exercises<a href="causality.html#solutions-to-selected-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-13.16-load-the-italy-and-china-data-described-in-example-13.3-and-included-in-the-supplementary-bookdown-material-into-r." class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Question 13.16: Load the Italy and China data, described in Example 13.3, and included in the supplementary Bookdown material into R.<a href="causality.html#question-13.16-load-the-italy-and-china-data-described-in-example-13.3-and-included-in-the-supplementary-bookdown-material-into-r." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data for this exercise follows that of Exercise 13.3, we can load it as follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="causality.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-2"><a href="causality.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-3"><a href="causality.html#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="causality.html#cb1-4" aria-hidden="true" tabindex="-1"></a>vonK_Data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/vonK_China_Italy.csv&quot;</span>) </span>
<span id="cb1-5"><a href="causality.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="causality.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate these datasets to have just two age ranges---$&lt;70$ and $\geq 70$.</span></span>
<span id="cb1-7"><a href="causality.html#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="causality.html#cb1-8" aria-hidden="true" tabindex="-1"></a>vonK_Data_70 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(vonK_Data, <span class="at">.keep =</span> <span class="st">&quot;unused&quot;</span>, <span class="at">Age_Range =</span> <span class="fu">fct_collapse</span>(<span class="st">`</span><span class="at">Age group</span><span class="st">`</span>, </span>
<span id="cb1-9"><a href="causality.html#cb1-9" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">Over_70 =</span> <span class="fu">c</span>(<span class="st">&quot;70-79&quot;</span>, <span class="st">&quot;80+&quot;</span>),</span>
<span id="cb1-10"><a href="causality.html#cb1-10" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">other_level =</span> <span class="st">&quot;Under_70&quot;</span> </span>
<span id="cb1-11"><a href="causality.html#cb1-11" aria-hidden="true" tabindex="-1"></a>                                                         )) </span>
<span id="cb1-12"><a href="causality.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="causality.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum up all death data grouped by age range and country</span></span>
<span id="cb1-14"><a href="causality.html#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="causality.html#cb1-15" aria-hidden="true" tabindex="-1"></a>vonK_Data_70 <span class="ot">&lt;-</span> vonK_Data_70 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Age_Range, Country) <span class="sc">|&gt;</span></span>
<span id="cb1-16"><a href="causality.html#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Fatalities =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Confirmed fatalities</span><span class="st">`</span>),</span>
<span id="cb1-17"><a href="causality.html#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Cases =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Confirmed cases</span><span class="st">`</span>), </span>
<span id="cb1-18"><a href="causality.html#cb1-18" aria-hidden="true" tabindex="-1"></a> <span class="at">.groups =</span> <span class="st">&quot;drop_last&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-19"><a href="causality.html#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Survived =</span> Total_Cases <span class="sc">-</span> Fatalities, <span class="at">.before =</span> Total_Cases) <span class="sc">|&gt;</span>  <span class="do">## Convert from fatalities to survivals</span></span>
<span id="cb1-20"><a href="causality.html#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Country) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span></code></pre></div>
<div id="i-display-a-2-by-2-contingency-table-of-deathssurvivors-vs.-chinaitaly-aggregated-over-all-age-groups." class="section level4 hasAnchor" number="13.1.1.1">
<h4><span class="header-section-number">13.1.1.1</span> i): Display a 2 by 2 contingency table of deaths/survivors vs. China/Italy aggregated over all age groups.<a href="causality.html#i-display-a-2-by-2-contingency-table-of-deathssurvivors-vs.-chinaitaly-aggregated-over-all-age-groups." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="causality.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Sum up all deaths by country</span></span>
<span id="cb2-2"><a href="causality.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="causality.html#cb2-3" aria-hidden="true" tabindex="-1"></a>vonK_Aggregated_Table <span class="ot">&lt;-</span> vonK_Data_70 <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="causality.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Age_Range) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="causality.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span> </span>
<span id="cb2-6"><a href="causality.html#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">c</span>(sum)) <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="causality.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 13.1: </span>Aggregated Contingency Table</caption>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Fatalities</th>
<th align="right">Survived</th>
<th align="right">Total_Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">China</td>
<td align="right">1023</td>
<td align="right">43649</td>
<td align="right">44672</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">357</td>
<td align="right">7669</td>
<td align="right">8026</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">1380</td>
<td align="right">51318</td>
<td align="right">52698</td>
</tr>
</tbody>
</table>
</div>
<div id="ii-display-2-by-2-contingency-tables-stratified-by-the-age-groups-70-and-geq-70." class="section level4 hasAnchor" number="13.1.1.2">
<h4><span class="header-section-number">13.1.1.2</span> ii): Display 2 by 2 contingency tables stratified by the age groups <span class="math inline">\(&lt;70\)</span> and <span class="math inline">\(\geq 70\)</span>.<a href="causality.html#ii-display-2-by-2-contingency-tables-stratified-by-the-age-groups-70-and-geq-70." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="causality.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Filter by age range and then sum up deaths</span></span>
<span id="cb3-2"><a href="causality.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="causality.html#cb3-3" aria-hidden="true" tabindex="-1"></a>vonK_Under70_Table <span class="ot">&lt;-</span> vonK_Data_70 <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="causality.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_Range <span class="sc">==</span> <span class="st">&quot;Under_70&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="causality.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Age_Range) <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href="causality.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) </span>
<span id="cb3-7"><a href="causality.html#cb3-7" aria-hidden="true" tabindex="-1"></a>vonK_Over70_Table <span class="ot">&lt;-</span> vonK_Data_70 <span class="sc">|&gt;</span> </span>
<span id="cb3-8"><a href="causality.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_Range <span class="sc">==</span> <span class="st">&quot;Over_70&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href="causality.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Age_Range) <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="causality.html#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-2">Table 13.2: </span>Under 70 Contingency Table</caption>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Fatalities</th>
<th align="right">Survived</th>
<th align="right">Total_Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">China</td>
<td align="right">503</td>
<td align="right">38843</td>
<td align="right">39346</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">41</td>
<td align="right">4668</td>
<td align="right">4709</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">544</td>
<td align="right">43511</td>
<td align="right">44055</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-3">Table 13.3: </span>Over 70 Contingency Table</caption>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Fatalities</th>
<th align="right">Survived</th>
<th align="right">Total_Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">China</td>
<td align="right">520</td>
<td align="right">4806</td>
<td align="right">5326</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">316</td>
<td align="right">3001</td>
<td align="right">3317</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">836</td>
<td align="right">7807</td>
<td align="right">8643</td>
</tr>
</tbody>
</table>
</div>
<div id="iii-does-a-simpsons-disaggregation-sdis-empirically-occur-in-these-two-tables" class="section level4 hasAnchor" number="13.1.1.3">
<h4><span class="header-section-number">13.1.1.3</span> iii): Does a Simpson’s disaggregation (SDis) empirically occur in these two tables?<a href="causality.html#iii-does-a-simpsons-disaggregation-sdis-empirically-occur-in-these-two-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Following the notation of the textbook (Example 13.3), let <span class="math inline">\(S\)</span> denote alive and <span class="math inline">\(\bar{S}\)</span> denote death. Let <span class="math inline">\(T\)</span> and <span class="math inline">\(\bar{T}\)</span> denote China and Italy. Finally, let <span class="math inline">\(C\)</span> and <span class="math inline">\(\bar{C}\)</span> denote the binarized age groups under 70 and over 70. Recall that
<span class="math display">\[
P_1 = Pr(S|T), \; P_2 = Pr(S|\tilde{T}), \; R_1 = Pr(S|\bar{C}T), \\ R_2 = Pr(S|\bar{C}\bar{T}), \; Q_1 = Pr(S|CT), \; Q_2 = Pr(S|C\bar{T}).
\]</span>
A Simpson’s disaggregation occurs when <span class="math inline">\(P_1 &gt; P_2\)</span>, while <span class="math inline">\(R_1 &lt; R_2\)</span> and <span class="math inline">\(Q_1 &lt; Q_2\)</span>.</p>
<p>We compute the empirical values denoted <span class="math inline">\(\hat{P}_1, \hat{P}_2, \hat{Q}_1, \hat{Q}_2, \hat{R}_1, \hat{R}_2\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="causality.html#cb4-1" aria-hidden="true" tabindex="-1"></a>P_hats <span class="ot">=</span> <span class="fu">head</span>(vonK_Aggregated_Table<span class="sc">$</span>Survived<span class="sc">/</span>vonK_Aggregated_Table<span class="sc">$</span>Total_Cases, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb4-2"><a href="causality.html#cb4-2" aria-hidden="true" tabindex="-1"></a>Q_hats <span class="ot">=</span> <span class="fu">head</span>(vonK_Under70_Table<span class="sc">$</span>Survived<span class="sc">/</span>vonK_Under70_Table<span class="sc">$</span>Total_Cases, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="causality.html#cb4-3" aria-hidden="true" tabindex="-1"></a>R_hats <span class="ot">=</span> <span class="fu">head</span>(vonK_Over70_Table<span class="sc">$</span>Survived<span class="sc">/</span>vonK_Over70_Table<span class="sc">$</span>Total_Cases, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb4-4"><a href="causality.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="causality.html#cb4-5" aria-hidden="true" tabindex="-1"></a>Solution <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">index =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">P_hat =</span> P_hats, <span class="at">Q_hat =</span> Q_hats, <span class="at">R_hat =</span> R_hats)</span>
<span id="cb4-6"><a href="causality.html#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="causality.html#cb4-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Solution)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">index</th>
<th align="right">P_hat</th>
<th align="right">Q_hat</th>
<th align="right">R_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.9770997</td>
<td align="right">0.9872160</td>
<td align="right">0.9023658</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.9555196</td>
<td align="right">0.9912933</td>
<td align="right">0.9047332</td>
</tr>
</tbody>
</table>
<p>Indeed, we see that <span class="math inline">\(\hat{P}_1 = 0.977 &gt; \hat{P}_2 = 0.956\)</span>, while <span class="math inline">\(\hat{Q}_1 = 0.987 &lt; \hat{Q}_2 = 0.991\)</span> and <span class="math inline">\(\hat{R}_1 = 0.902 &lt; \hat{R}_2 = 0.905\)</span>, hence a Simpson’s disaggregation has occured.</p>
</div>
</div>
<div id="question-13.17-using-the-italy-and-china-data-stratified-by-the-age-groups-70-and-geq-70-obtain-empirical-estimates-of-p_1-and-p_2-as-defined-in-an-sdis.-in-the-following-questions-assume-that-p_1-and-p_2-are-the-population-values." class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Question 13.17: Using the Italy and China data stratified by the age groups <span class="math inline">\(&lt;70\)</span> and <span class="math inline">\(\geq 70\)</span>, obtain empirical estimates of <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span>, as defined in an SDis. In the following questions, assume that <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span> are the population values.<a href="causality.html#question-13.17-using-the-italy-and-china-data-stratified-by-the-age-groups-70-and-geq-70-obtain-empirical-estimates-of-p_1-and-p_2-as-defined-in-an-sdis.-in-the-following-questions-assume-that-p_1-and-p_2-are-the-population-values." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="i-what-are-the-possible-ranges-of-gamma_1-and-gamma_2-for-a-controlled-sdis-to-exist-can-you-visualize-it-in-the-rectangle-012-keep-all-intermediate-computations-to-three-decimal-precision." class="section level4 hasAnchor" number="13.1.2.1">
<h4><span class="header-section-number">13.1.2.1</span> i): What are the possible ranges of <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> for a controlled SDis to exist (can you visualize it in the rectangle <span class="math inline">\([0,1]^2\)</span>)? Keep all intermediate computations to three decimal precision.<a href="causality.html#i-what-are-the-possible-ranges-of-gamma_1-and-gamma_2-for-a-controlled-sdis-to-exist-can-you-visualize-it-in-the-rectangle-012-keep-all-intermediate-computations-to-three-decimal-precision." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We compute <span class="math inline">\(R\)</span> as defined in Theorem 2, with <span class="math inline">\(P_i = \hat{P}_i\)</span>.</p>
<p><span class="math display">\[
R = \frac{P_2/(1-P_2)}{P_1/(1-P_1)} = \frac{0.956/0.044}{0.977/0.023} = 0.511.
\]</span>
The allowable region defined by Theorem 2 is hence:</p>
<p><span class="math display">\[
\Gamma &lt; 0.511 \implies \frac{\gamma_2/(1-\gamma_2)}{\gamma_1/(1-\gamma_1)} &lt; 0.511, \; \gamma_2 \leq \gamma_1.
\]</span>
One can plug the above inequality into freeware such as (Desmos)[<a href="https://www.desmos.com/" class="uri">https://www.desmos.com/</a>] or (Wolfram-Alpha)[<a href="https://www.wolframalpha.com/" class="uri">https://www.wolframalpha.com/</a>] to visualize the region.</p>
</div>
<div id="ii-suppose-a-centered-interval-for-the-gammas-are-desired-i.e.-gamma_1-1---gamma_2.-what-are-the-allowable-values-of-gamma_1-and-gamma_2-furthermore-what-choices-considering-three-decimal-points-yield-the-tightest-interval-for-beta_i" class="section level4 hasAnchor" number="13.1.2.2">
<h4><span class="header-section-number">13.1.2.2</span> ii): Suppose a centered interval for the <span class="math inline">\(\gamma\)</span>’s are desired, i.e., <span class="math inline">\(\gamma_1 = 1 - \gamma_2\)</span>. What are the allowable values of <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span>? Furthermore, what choices (considering three decimal points) yield the tightest interval for <span class="math inline">\(\beta_i\)</span>?<a href="causality.html#ii-suppose-a-centered-interval-for-the-gammas-are-desired-i.e.-gamma_1-1---gamma_2.-what-are-the-allowable-values-of-gamma_1-and-gamma_2-furthermore-what-choices-considering-three-decimal-points-yield-the-tightest-interval-for-beta_i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can re-write the above by substituting <span class="math inline">\(\gamma_1 = 1 - \gamma_2\)</span> as</p>
<p><span class="math display">\[
\frac{\gamma_2/(1-\gamma_2)}{(1-\gamma_2)(1-(1-\gamma_2))} = \left(\frac{\gamma_2}{1-\gamma_2}\right)^2 &lt; 0.511,
\]</span>
which, taking only the positive solution of the square root, yields the allowable interval for <span class="math inline">\(\gamma_2\)</span>
<span class="math display">\[
\gamma_2 &lt; 0.417,
\]</span>
implying that <span class="math inline">\(\gamma_1 &gt; 0.583\)</span>. Being conservative up to three decimal points, the smallest interval is hence <span class="math inline">\([0.416, 0.584]\)</span>.</p>
</div>
<div id="iii-compute-empirical-estimates-of-beta_1-and-beta_2-and-interpret-these-values." class="section level4 hasAnchor" number="13.1.2.3">
<h4><span class="header-section-number">13.1.2.3</span> iii): Compute empirical estimates of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>, and interpret these values.<a href="causality.html#iii-compute-empirical-estimates-of-beta_1-and-beta_2-and-interpret-these-values." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall that <span class="math inline">\(\beta_1 = Pr(T|\bar{C}), \beta_2 = Pr(T|C)\)</span>. In our context, an empirical estimate of <span class="math inline">\(\beta_1\)</span> is hence the proportion of Chinese patients over 70, and <span class="math inline">\(\beta_2\)</span> the proportion of Chinese patients under 70.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="causality.html#cb5-1" aria-hidden="true" tabindex="-1"></a>beta_hat_1 <span class="ot">&lt;-</span> vonK_Over70_Table<span class="sc">$</span>Total_Cases[<span class="dv">1</span>]<span class="sc">/</span>vonK_Over70_Table<span class="sc">$</span>Total_Cases[<span class="dv">3</span>]</span>
<span id="cb5-2"><a href="causality.html#cb5-2" aria-hidden="true" tabindex="-1"></a>beta_hat_2 <span class="ot">&lt;-</span> vonK_Under70_Table<span class="sc">$</span>Total_Cases[<span class="dv">2</span>]<span class="sc">/</span>vonK_Over70_Table<span class="sc">$</span>Total_Cases[<span class="dv">3</span>]</span>
<span id="cb5-3"><a href="causality.html#cb5-3" aria-hidden="true" tabindex="-1"></a>beta_hats <span class="ot">&lt;-</span> <span class="fu">c</span>(beta_hat_1, beta_hat_2)</span>
<span id="cb5-4"><a href="causality.html#cb5-4" aria-hidden="true" tabindex="-1"></a>Solution <span class="ot">&lt;-</span> Solution <span class="sc">|&gt;</span> <span class="fu">add_column</span>(<span class="at">beta_hat =</span> beta_hats)</span>
<span id="cb5-5"><a href="causality.html#cb5-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Solution)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">index</th>
<th align="right">P_hat</th>
<th align="right">Q_hat</th>
<th align="right">R_hat</th>
<th align="right">beta_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.9770997</td>
<td align="right">0.9872160</td>
<td align="right">0.9023658</td>
<td align="right">0.6162212</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.9555196</td>
<td align="right">0.9912933</td>
<td align="right">0.9047332</td>
<td align="right">0.5448340</td>
</tr>
</tbody>
</table>
<p>We obtain <span class="math inline">\(\hat{\beta}_1 = 0.616\)</span> and <span class="math inline">\(\hat{\beta}_2 = 0.545\)</span>.</p>
</div>
<div id="iv-bonus-what-is-the-tightest-centered-interval-at-frac12hatbeta_1---hatbeta_2-for-gamma_1-and-gamma_2-such-that-a-controlled-sdis-can-theoretically-exist-assuming-population-parameters-how-well-does-it-cover-the-estimated-hatbeta_i-if-at-all-was-the-empirically-observed-sdis-surprising-given-these-results" class="section level4 hasAnchor" number="13.1.2.4">
<h4><span class="header-section-number">13.1.2.4</span> iv) (Bonus): What is the tightest centered interval at <span class="math inline">\(\frac{1}{2}(\hat{\beta}_1 - \hat{\beta}_2)\)</span> for <span class="math inline">\(\gamma_1\)</span> and <span class="math inline">\(\gamma_2\)</span> such that a controlled SDis can theoretically exist (assuming population parameters)? How well does it cover the estimated <span class="math inline">\(\hat{\beta}_i\)</span> (if at all)? Was the empirically observed SDis surprising given these results?<a href="causality.html#iv-bonus-what-is-the-tightest-centered-interval-at-frac12hatbeta_1---hatbeta_2-for-gamma_1-and-gamma_2-such-that-a-controlled-sdis-can-theoretically-exist-assuming-population-parameters-how-well-does-it-cover-the-estimated-hatbeta_i-if-at-all-was-the-empirically-observed-sdis-surprising-given-these-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We compute the average:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="causality.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(beta_hat_1, beta_hat_2))</span></code></pre></div>
<pre><code>## [1] 0.5805276</code></pre>
<p>We wish to have the tightest interval centered at <span class="math inline">\(0.581\)</span> such that <span class="math inline">\(\gamma_1, \gamma_2\)</span> satisfy
<span class="math display">\[
\frac{\gamma_2/(1-\gamma_2)}{\gamma_1/(1-\gamma_1)} &lt; 0.511, \; \gamma_2 \leq \gamma_1.
\]</span>
We can re-write this as follows. The desired interval is <span class="math inline">\([0.581-\gamma, 0.581+\gamma]\)</span>, setting <span class="math inline">\(\gamma_2 = 0.581-\gamma, \gamma_1 = 0.581+\gamma\)</span>. Using numerical methods accessed via (Wolfram-Alpha)[<a href="https://www.wolframalpha.com/" class="uri">https://www.wolframalpha.com/</a>], we obtain the inequality
<span class="math display">\[
\gamma &gt; 0.081
\]</span>
This indicates that <span class="math inline">\(\gamma = 0.080\)</span> is a boundary value (at 3 decimal points), and hence the tightest interval is <span class="math inline">\([0.501, 0.661]\)</span>, which well-covers the estimated <span class="math inline">\(\hat{\beta}\)</span>. This indicates that perhaps the empirical existence of an SDis is not so surprising.</p>
</div>
</div>
<div id="question-13.18-stratify-the-italy-and-china-data-by-the-age-groups-50-and-geq-50.-display-the-corresponding-contingency-tables." class="section level3 hasAnchor" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Question 13.18: Stratify the Italy and China data by the age groups <span class="math inline">\(&lt;50\)</span> and <span class="math inline">\(\geq 50\)</span>. Display the corresponding contingency tables.<a href="causality.html#question-13.18-stratify-the-italy-and-china-data-by-the-age-groups-50-and-geq-50.-display-the-corresponding-contingency-tables." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Re-loading the data and re-stratifying:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="causality.html#cb8-1" aria-hidden="true" tabindex="-1"></a>vonK_Data_50 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(vonK_Data, <span class="at">.keep =</span> <span class="st">&quot;unused&quot;</span>, <span class="at">Age_Range =</span> <span class="fu">fct_collapse</span>(<span class="st">`</span><span class="at">Age group</span><span class="st">`</span>, </span>
<span id="cb8-2"><a href="causality.html#cb8-2" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">Over_50 =</span> <span class="fu">c</span>(<span class="st">&quot;50-59&quot;</span>, <span class="st">&quot;60-69&quot;</span>, <span class="st">&quot;70-79&quot;</span>, <span class="st">&quot;80+&quot;</span>),</span>
<span id="cb8-3"><a href="causality.html#cb8-3" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">other_level =</span> <span class="st">&quot;Under_50&quot;</span> </span>
<span id="cb8-4"><a href="causality.html#cb8-4" aria-hidden="true" tabindex="-1"></a>                                                         )) </span></code></pre></div>
<div id="i-does-an-sdis-still-occur-why-or-why-not" class="section level4 hasAnchor" number="13.1.3.1">
<h4><span class="header-section-number">13.1.3.1</span> i): Does an SDis still occur? Why or why not?<a href="causality.html#i-does-an-sdis-still-occur-why-or-why-not" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We reproduce the contingency tables of Exercise 13.16.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="causality.html#cb9-1" aria-hidden="true" tabindex="-1"></a>vonK_Data_50 <span class="ot">&lt;-</span> vonK_Data_50 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Age_Range, Country) <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="causality.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Fatalities =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Confirmed fatalities</span><span class="st">`</span>),</span>
<span id="cb9-3"><a href="causality.html#cb9-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Cases =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Confirmed cases</span><span class="st">`</span>), </span>
<span id="cb9-4"><a href="causality.html#cb9-4" aria-hidden="true" tabindex="-1"></a> <span class="at">.groups =</span> <span class="st">&quot;drop_last&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="causality.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Survived =</span> Total_Cases <span class="sc">-</span> Fatalities, <span class="at">.before =</span> Total_Cases) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="causality.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Country) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span>
<span id="cb9-7"><a href="causality.html#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="causality.html#cb9-8" aria-hidden="true" tabindex="-1"></a>vonK_Aggregated_Table <span class="ot">&lt;-</span> vonK_Data_50 <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="causality.html#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Age_Range) <span class="sc">|&gt;</span> </span>
<span id="cb9-10"><a href="causality.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span> </span>
<span id="cb9-11"><a href="causality.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">c</span>(sum)) <span class="sc">|&gt;</span> </span>
<span id="cb9-12"><a href="causality.html#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>)</span>
<span id="cb9-13"><a href="causality.html#cb9-13" aria-hidden="true" tabindex="-1"></a>vonK_Under50_Table <span class="ot">&lt;-</span> vonK_Data_50 <span class="sc">|&gt;</span> </span>
<span id="cb9-14"><a href="causality.html#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_Range <span class="sc">==</span> <span class="st">&quot;Under_50&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-15"><a href="causality.html#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Age_Range) <span class="sc">|&gt;</span> <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) </span>
<span id="cb9-16"><a href="causality.html#cb9-16" aria-hidden="true" tabindex="-1"></a>vonK_Over50_Table <span class="ot">&lt;-</span> vonK_Data_50 <span class="sc">|&gt;</span> </span>
<span id="cb9-17"><a href="causality.html#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_Range <span class="sc">==</span> <span class="st">&quot;Over_50&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-18"><a href="causality.html#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Age_Range) <span class="sc">|&gt;</span> </span>
<span id="cb9-19"><a href="causality.html#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>)</span></code></pre></div>
<p>Displaying the tables:</p>
<table>
<caption><span id="tab:unnamed-chunk-4">Table 13.4: </span>Aggregated Contingency Table</caption>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Fatalities</th>
<th align="right">Survived</th>
<th align="right">Total_Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">China</td>
<td align="right">1023</td>
<td align="right">43649</td>
<td align="right">44672</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">357</td>
<td align="right">7669</td>
<td align="right">8026</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">1380</td>
<td align="right">51318</td>
<td align="right">52698</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 13.5: </span>Under 50 Contingency Table</caption>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Fatalities</th>
<th align="right">Survived</th>
<th align="right">Total_Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">China</td>
<td align="right">64</td>
<td align="right">20691</td>
<td align="right">20755</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">1</td>
<td align="right">1784</td>
<td align="right">1785</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">65</td>
<td align="right">22475</td>
<td align="right">22540</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-6">Table 13.6: </span>Over 50 Contingency Table</caption>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Fatalities</th>
<th align="right">Survived</th>
<th align="right">Total_Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">China</td>
<td align="right">959</td>
<td align="right">22958</td>
<td align="right">23917</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">356</td>
<td align="right">5885</td>
<td align="right">6241</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">1315</td>
<td align="right">28843</td>
<td align="right">30158</td>
</tr>
</tbody>
</table>
<p>Now, checking if an SDis still occurs.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="causality.html#cb10-1" aria-hidden="true" tabindex="-1"></a>P_hats <span class="ot">&lt;-</span> <span class="fu">head</span>(vonK_Aggregated_Table<span class="sc">$</span>Survived<span class="sc">/</span>vonK_Aggregated_Table<span class="sc">$</span>Total_Cases, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-2"><a href="causality.html#cb10-2" aria-hidden="true" tabindex="-1"></a>Q_hats <span class="ot">&lt;-</span> <span class="fu">head</span>(vonK_Under50_Table<span class="sc">$</span>Survived<span class="sc">/</span>vonK_Under50_Table<span class="sc">$</span>Total_Cases, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-3"><a href="causality.html#cb10-3" aria-hidden="true" tabindex="-1"></a>R_hats <span class="ot">&lt;-</span> <span class="fu">head</span>(vonK_Over50_Table<span class="sc">$</span>Survived<span class="sc">/</span>vonK_Over50_Table<span class="sc">$</span>Total_Cases, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="causality.html#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="causality.html#cb10-5" aria-hidden="true" tabindex="-1"></a>Solution <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">index =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">P_hat =</span> P_hats, <span class="at">Q_hat =</span> Q_hats, <span class="at">R_hat =</span> R_hats)</span>
<span id="cb10-6"><a href="causality.html#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="causality.html#cb10-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Solution)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">index</th>
<th align="right">P_hat</th>
<th align="right">Q_hat</th>
<th align="right">R_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.9770997</td>
<td align="right">0.9969164</td>
<td align="right">0.9599030</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.9555196</td>
<td align="right">0.9994398</td>
<td align="right">0.9429579</td>
</tr>
</tbody>
</table>
<p>An SDis no longer occurs. <span class="math inline">\(\hat{P}_1 = 0.977 &gt; \hat{P}_2 = 0.956\)</span>, but <span class="math inline">\(\hat{R}_1 = 0.960 &gt; \hat{R}_2 = 0.943\)</span> also. Probabilistically: different definitions of the random variables involved change the probabilities (empirical or population), and an SDis is not at all guaranteed to appear, even under the same dataset. Conceptually: see Figure 1 in Von Kügelen et al. Although each 10-year range results in a higher CFR for China, the aggregated data shows a higher CFR for Italy. This is exactly Simpson’s paradox. The same aggregation phenomenon happens in our binarization, resulting in a smaller version of Simpson’s paradox. By aggregating the bins 50-80+, we have produced an estimate where the Italian CFR is higher than the Chinese, resulting in a similar bin to the “Total” one given in Figure 1.</p>
</div>
<div id="ii-compute-hatbeta_1-and-hatbeta_2-and-repeat-the-bonus-question-of-exercise-13.17.-what-has-changed-do-the-changes-match-your-observations" class="section level4 hasAnchor" number="13.1.3.2">
<h4><span class="header-section-number">13.1.3.2</span> ii): Compute <span class="math inline">\(\hat{\beta}_1\)</span> and <span class="math inline">\(\hat{\beta}_2\)</span>, and repeat the bonus question of Exercise 13.17. What has changed? Do the changes match your observations?<a href="causality.html#ii-compute-hatbeta_1-and-hatbeta_2-and-repeat-the-bonus-question-of-exercise-13.17.-what-has-changed-do-the-changes-match-your-observations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Note that because the aggregated data does not change from Exercise 13.17, our estimates for <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span> also remain the same. Therefore, the allowable region for <span class="math inline">\(\gamma_i\)</span> does not change:
<span class="math display">\[
\frac{\gamma_2/(1-\gamma_2)}{\gamma_1/(1-\gamma_1)} &lt; 0.511, \; \gamma_2 \leq \gamma_1.
\]</span></p>
<p>We first compute <span class="math inline">\(\hat{\beta_i}\)</span> again.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="causality.html#cb11-1" aria-hidden="true" tabindex="-1"></a>beta_hat_1 <span class="ot">&lt;-</span> vonK_Over50_Table<span class="sc">$</span>Total_Cases[<span class="dv">1</span>]<span class="sc">/</span>vonK_Over50_Table<span class="sc">$</span>Total_Cases[<span class="dv">3</span>]</span>
<span id="cb11-2"><a href="causality.html#cb11-2" aria-hidden="true" tabindex="-1"></a>beta_hat_2 <span class="ot">&lt;-</span> vonK_Under50_Table<span class="sc">$</span>Total_Cases[<span class="dv">1</span>]<span class="sc">/</span>vonK_Over50_Table<span class="sc">$</span>Total_Cases[<span class="dv">3</span>]</span>
<span id="cb11-3"><a href="causality.html#cb11-3" aria-hidden="true" tabindex="-1"></a>beta_hats <span class="ot">&lt;-</span> <span class="fu">c</span>(beta_hat_1, beta_hat_2)</span>
<span id="cb11-4"><a href="causality.html#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="causality.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(beta_hats)</span></code></pre></div>
<pre><code>## [1] 0.7930566 0.6882088</code></pre>
<p>We obtain <span class="math inline">\(\hat{\beta}_1 = 0.793\)</span>, while <span class="math inline">\(\hat{\beta}_2 = 0.688\)</span>. We compute their mid-point to be <span class="math inline">\(0.741\)</span>. Hence, we look for an interval of the form <span class="math inline">\([0.741 - \gamma, 0.741 + \gamma]\)</span>. Repeating the exercise, we obtain
<span class="math display">\[
\gamma &gt; 0.063.
\]</span>
Taking <span class="math inline">\(\gamma = 0.064\)</span>, this results in the interval <span class="math inline">\([0.677, 0.805]\)</span>. our estimated <span class="math inline">\(\hat{\beta}_i\)</span> does still fall in this interval, but it is near the boundary values. This perhaps suggests that an SDis was less likely to occur in this stratification (and indeed, it does not occur empirically).</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exposure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monitoring.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/13-Chpt13.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
